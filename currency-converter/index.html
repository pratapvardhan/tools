<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Currency Converter</title>
    <meta name="description" content="Convert currency from one to another.">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            color: #000000;
            line-height: 1.6;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .converter {
            border: 1px solid #ddd;
            padding: 25px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .input-group {
            margin-bottom: 15px;
        }
        select, input {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #45a049;
        }
        #result {
            margin-top: 20px;
            font-size: 1.4em;
            font-weight: 500;
            text-align: center;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        .swap-btn {
            background-color: transparent;
            color: #666;
            width: auto;
            padding: 8px;
        }
        .swap-btn:hover {
            background-color: #f0f0f0;
            color: #333;
        }
        .currency-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
            position: relative;
        }
        .currency-group .input-group {
            flex: 1;
            margin-bottom: 0;
            width: 100%;
        }
        .currency-group .swap-btn {
            position: absolute;
            right: 0;
            top: 50%;
            margin: 0;
            padding: 4px;
        }
        .select2-container {
            width: 100% !important;
        }
        .currency-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .currency-flag {
            font-size: 1.2em;
        }
        .select2-container .select2-selection--single {
            height: 43px !important;
        }
        .select2-container--default .select2-selection--single {
            border: 1px solid #ddd !important;
            border-radius: 4px !important;
        }
        .select2-container--default .select2-selection--single .select2-selection__rendered {
            line-height: 43px !important;
            padding-left: 10px !important;
        }
        .select2-container--default .select2-selection--single .select2-selection__arrow {
            height: 41px !important;
        }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
</head>
<body>
    <div class="converter">
        <h2>Currency Converter</h2>
        <div class="input-group">
            <label for="amount">Amount</label>
            <input type="number" id="amount" value="1" oninput="convertCurrency()">
        </div>
        <div class="currency-group">
            <div class="input-group">
                <label for="fromCurrency">From</label>
                <select id="fromCurrency" onchange="convertCurrency()"></select>
            </div>
            <button onclick="swapCurrencies()" class="swap-btn">‚Üë‚Üì</button>
            <div class="input-group">
                <label for="toCurrency">To</label>
                <select id="toCurrency" onchange="convertCurrency()"></select>
            </div>
        </div>
        <button onclick="convertCurrency()">Convert</button>
        <div id="result"></div>
        <div style="margin-top: 20px; font-size: 0.8em; color: #666;">
            <div id="lastUpdate"></div>
            <div>Data from <a href="https://www.exchangerate-api.com" target="_blank">ExchangeRate-API</a></div>
        </div>
    </div>

    <script>
        let rates = {};
        const currencyInfo = {
            USD: { name: "United States Dollar", flag: "üá∫üá∏" },
            AED: { name: "Emirati Dirham", flag: "üá¶üá™" },
            AFN: { name: "Afghan Afghani", flag: "üá¶üá´" },
            ALL: { name: "Albanian Lek", flag: "üá¶üá±" },
            AMD: { name: "Armenian Dram", flag: "üá¶üá≤" },
            ANG: { name: "Netherlands Antillean Guilder", flag: "üá®üáº" },
            AOA: { name: "Angolan Kwanza", flag: "üá¶üá¥" },
            ARS: { name: "Argentine Peso", flag: "üá¶üá∑" },
            AUD: { name: "Australian Dollar", flag: "üá¶üá∫" },
            AWG: { name: "Aruban Florin", flag: "üá¶üáº" },
            AZN: { name: "Azerbaijani Manat", flag: "üá¶üáø" },
            BAM: { name: "Bosnia-Herzegovina Convertible Mark", flag: "üáßüá¶" },
            BBD: { name: "Barbadian Dollar", flag: "üáßüáß" },
            BDT: { name: "Bangladeshi Taka", flag: "üáßüá©" },
            BGN: { name: "Bulgarian Lev", flag: "üáßüá¨" },
            BHD: { name: "Bahraini Dinar", flag: "üáßüá≠" },
            BIF: { name: "Burundian Franc", flag: "üáßüáÆ" },
            BMD: { name: "Bermudan Dollar", flag: "üáßüá≤" },
            BND: { name: "Brunei Dollar", flag: "üáßüá≥" },
            BOB: { name: "Bolivian Boliviano", flag: "üáßüá¥" },
            BRL: { name: "Brazilian Real", flag: "üáßüá∑" },
            BSD: { name: "Bahamian Dollar", flag: "üáßüá∏" },
            BTN: { name: "Bhutanese Ngultrum", flag: "üáßüáπ" },
            BWP: { name: "Botswanan Pula", flag: "üáßüáº" },
            BYN: { name: "Belarusian Ruble", flag: "üáßüáæ" },
            BZD: { name: "Belize Dollar", flag: "üáßüáø" },
            CAD: { name: "Canadian Dollar", flag: "üá®üá¶" },
            CDF: { name: "Congolese Franc", flag: "üá®üá©" },
            CHF: { name: "Swiss Franc", flag: "üá®üá≠" },
            CLP: { name: "Chilean Peso", flag: "üá®üá±" },
            CNY: { name: "Chinese Yuan", flag: "üá®üá≥" },
            COP: { name: "Colombian Peso", flag: "üá®üá¥" },
            CRC: { name: "Costa Rican Col√≥n", flag: "üá®üá∑" },
            CUP: { name: "Cuban Peso", flag: "üá®üá∫" },
            CVE: { name: "Cape Verdean Escudo", flag: "üá®üáª" },
            CZK: { name: "Czech Koruna", flag: "üá®üáø" },
            DJF: { name: "Djiboutian Franc", flag: "üá©üáØ" },
            DKK: { name: "Danish Krone", flag: "üá©üá∞" },
            DOP: { name: "Dominican Peso", flag: "üá©üá¥" },
            DZD: { name: "Algerian Dinar", flag: "üá©üáø" },
            EGP: { name: "Egyptian Pound", flag: "üá™üá¨" },
            ERN: { name: "Eritrean Nakfa", flag: "üá™üá∑" },
            ETB: { name: "Ethiopian Birr", flag: "üá™üáπ" },
            EUR: { name: "Euro", flag: "üá™üá∫" },
            FJD: { name: "Fijian Dollar", flag: "üá´üáØ" },
            FKP: { name: "Falkland Islands Pound", flag: "üá´üá∞" },
            FOK: { name: "Faroese Kr√≥na", flag: "üá´üá¥" },
            GBP: { name: "British Pound", flag: "üá¨üáß" },
            GEL: { name: "Georgian Lari", flag: "üá¨üá™" },
            GGP: { name: "Guernsey Pound", flag: "üá¨üá¨" },
            GHS: { name: "Ghanaian Cedi", flag: "üá¨üá≠" },
            GIP: { name: "Gibraltar Pound", flag: "üá¨üáÆ" },
            GMD: { name: "Gambian Dalasi", flag: "üá¨üá≤" },
            GNF: { name: "Guinean Franc", flag: "üá¨üá≥" },
            GTQ: { name: "Guatemalan Quetzal", flag: "üá¨üáπ" },
            GYD: { name: "Guyanaese Dollar", flag: "üá¨üáæ" },
            HKD: { name: "Hong Kong Dollar", flag: "üá≠üá∞" },
            HNL: { name: "Honduran Lempira", flag: "üá≠üá≥" },
            HRK: { name: "Croatian Kuna", flag: "üá≠üá∑" },
            HTG: { name: "Haitian Gourde", flag: "üá≠üáπ" },
            HUF: { name: "Hungarian Forint", flag: "üá≠üá∫" },
            IDR: { name: "Indonesian Rupiah", flag: "üáÆüá©" },
            ILS: { name: "Israeli New Shekel", flag: "üáÆüá±" },
            IMP: { name: "Manx Pound", flag: "üáÆüá≤" },
            INR: { name: "Indian Rupee", flag: "üáÆüá≥" },
            IQD: { name: "Iraqi Dinar", flag: "üáÆüá∂" },
            IRR: { name: "Iranian Rial", flag: "üáÆüá∑" },
            ISK: { name: "Icelandic Kr√≥na", flag: "üáÆüá∏" },
            JEP: { name: "Jersey Pound", flag: "üáØüá™" },
            JMD: { name: "Jamaican Dollar", flag: "üáØüá≤" },
            JOD: { name: "Jordanian Dinar", flag: "üáØüá¥" },
            JPY: { name: "Japanese Yen", flag: "üáØüáµ" },
            KES: { name: "Kenyan Shilling", flag: "üá∞üá™" },
            KGS: { name: "Kyrgystani Som", flag: "üá∞üá¨" },
            KHR: { name: "Cambodian Riel", flag: "üá∞üá≠" },
            KID: { name: "Kiribati Dollar", flag: "üá∞üáÆ" },
            KMF: { name: "Comorian Franc", flag: "üá∞üá≤" },
            KRW: { name: "South Korean Won", flag: "üá∞üá∑" },
            KWD: { name: "Kuwaiti Dinar", flag: "üá∞üáº" },
            KYD: { name: "Cayman Islands Dollar", flag: "üá∞üáæ" },
            KZT: { name: "Kazakhstani Tenge", flag: "üá∞üáø" },
            LAK: { name: "Laotian Kip", flag: "üá±üá¶" },
            LBP: { name: "Lebanese Pound", flag: "üá±üáß" },
            LKR: { name: "Sri Lankan Rupee", flag: "üá±üá∞" },
            LRD: { name: "Liberian Dollar", flag: "üá±üá∑" },
            LSL: { name: "Lesotho Loti", flag: "üá±üá∏" },
            LYD: { name: "Libyan Dinar", flag: "üá±üáæ" },
            MAD: { name: "Moroccan Dirham", flag: "üá≤üá¶" },
            MDL: { name: "Moldovan Leu", flag: "üá≤üá©" },
            MGA: { name: "Malagasy Ariary", flag: "üá≤üá¨" },
            MKD: { name: "Macedonian Denar", flag: "üá≤üá∞" },
            MMK: { name: "Myanmar Kyat", flag: "üá≤üá≤" },
            MNT: { name: "Mongolian Tugrik", flag: "üá≤üá≥" },
            MOP: { name: "Macanese Pataca", flag: "üá≤üá¥" },
            MRU: { name: "Mauritanian Ouguiya", flag: "üá≤üá∑" },
            MUR: { name: "Mauritian Rupee", flag: "üá≤üá∫" },
            MVR: { name: "Maldivian Rufiyaa", flag: "üá≤üáª" },
            MWK: { name: "Malawian Kwacha", flag: "üá≤üáº" },
            MXN: { name: "Mexican Peso", flag: "üá≤üáΩ" },
            MYR: { name: "Malaysian Ringgit", flag: "üá≤üáæ" },
            MZN: { name: "Mozambican Metical", flag: "üá≤üáø" },
            NAD: { name: "Namibian Dollar", flag: "üá≥üá¶" },
            NGN: { name: "Nigerian Naira", flag: "üá≥üá¨" },
            NIO: { name: "Nicaraguan C√≥rdoba", flag: "üá≥üáÆ" },
            NOK: { name: "Norwegian Krone", flag: "üá≥üá¥" },
            NPR: { name: "Nepalese Rupee", flag: "üá≥üáµ" },
            NZD: { name: "New Zealand Dollar", flag: "üá≥üáø" },
            OMR: { name: "Omani Rial", flag: "üá¥üá≤" },
            PAB: { name: "Panamanian Balboa", flag: "üáµüá¶" },
            PEN: { name: "Peruvian Sol", flag: "üáµüá™" },
            PGK: { name: "Papua New Guinean Kina", flag: "üáµüá¨" },
            PHP: { name: "Philippine Peso", flag: "üáµüá≠" },
            PKR: { name: "Pakistani Rupee", flag: "üáµüá∞" },
            PLN: { name: "Polish Z≈Çoty", flag: "üáµüá±" },
            PYG: { name: "Paraguayan Guaran√≠", flag: "üáµüáæ" },
            QAR: { name: "Qatari Rial", flag: "üá∂üá¶" },
            RON: { name: "Romanian Leu", flag: "üá∑üá¥" },
            RSD: { name: "Serbian Dinar", flag: "üá∑üá∏" },
            RUB: { name: "Russian Ruble", flag: "üá∑üá∫" },
            RWF: { name: "Rwandan Franc", flag: "üá∑üáº" },
            SAR: { name: "Saudi Riyal", flag: "üá∏üá¶" },
            SBD: { name: "Solomon Islands Dollar", flag: "üá∏üáß" },
            SCR: { name: "Seychellois Rupee", flag: "üá∏üá®" },
            SDG: { name: "Sudanese Pound", flag: "üá∏üá©" },
            SEK: { name: "Swedish Krona", flag: "üá∏üá™" },
            SGD: { name: "Singapore Dollar", flag: "üá∏üá¨" },
            SHP: { name: "Saint Helena Pound", flag: "üá∏üá≠" },
            SLE: { name: "Sierra Leonean Leone", flag: "üá∏üá±" },
            SLL: { name: "Sierra Leonean Leone", flag: "üá∏üá±" },
            SOS: { name: "Somali Shilling", flag: "üá∏üá¥" },
            SRD: { name: "Surinamese Dollar", flag: "üá∏üá∑" },
            SSP: { name: "South Sudanese Pound", flag: "üá∏üá∏" },
            STN: { name: "S√£o Tom√© and Pr√≠ncipe Dobra", flag: "üá∏üáπ" },
            SYP: { name: "Syrian Pound", flag: "üá∏üáæ" },
            SZL: { name: "Swazi Lilangeni", flag: "üá∏üáø" },
            THB: { name: "Thai Baht", flag: "üáπüá≠" },
            TJS: { name: "Tajikistani Somoni", flag: "üáπüáØ" },
            TMT: { name: "Turkmenistani Manat", flag: "üáπüá≤" },
            TND: { name: "Tunisian Dinar", flag: "üáπüá≥" },
            TOP: { name: "Tongan Pa ªanga", flag: "üáπüá¥" },
            TRY: { name: "Turkish Lira", flag: "üáπüá∑" },
            TTD: { name: "Trinidad and Tobago Dollar", flag: "üáπüáπ" },
            TVD: { name: "Tuvaluan Dollar", flag: "üáπüáª" },
            TWD: { name: "New Taiwan Dollar", flag: "üáπüáº" },
            TZS: { name: "Tanzanian Shilling", flag: "üáπüáø" },
            UAH: { name: "Ukrainian Hryvnia", flag: "üá∫üá¶" },
            UGX: { name: "Ugandan Shilling", flag: "üá∫üá¨" },
            UYU: { name: "Uruguayan Peso", flag: "üá∫üáæ" },
            UZS: { name: "Uzbekistani Som", flag: "üá∫üáø" },
            VES: { name: "Venezuelan Bol√≠var", flag: "üáªüá™" },
            VND: { name: "Vietnamese ƒê·ªìng", flag: "üáªüá≥" },
            VUV: { name: "Vanuatu Vatu", flag: "üáªüá∫" },
            WST: { name: "Samoan TƒÅlƒÅ", flag: "üáºüá∏" },
            XAF: { name: "Central African CFA Franc", flag: "üá®üá´" },
            XCD: { name: "East Caribbean Dollar", flag: "üá¶üá¨" },
            XDR: { name: "Special Drawing Rights", flag: "üåê" },
            XOF: { name: "West African CFA Franc", flag: "üáßüá´" },
            XPF: { name: "CFP Franc", flag: "üáµüá´" },
            YER: { name: "Yemeni Rial", flag: "üáæüá™" },
            ZAR: { name: "South African Rand", flag: "üáøüá¶" },
            ZMW: { name: "Zambian Kwacha", flag: "üáøüá≤" },
            ZWL: { name: "Zimbabwean Dollar", flag: "üáøüáº" }
        };


        async function initialize() {
            try {
                const response = await fetch('https://open.er-api.com/v6/latest/USD');
                const data = await response.json();
                rates = data.rates;
                
                document.getElementById('lastUpdate').innerHTML = `Last updated: ${data.time_last_update_utc.slice(0, 16)}`;
                
                const currencies = Object.keys(rates);
                const fromSelect = document.getElementById('fromCurrency');
                const toSelect = document.getElementById('toCurrency');
                
                currencies.forEach(currency => {
                    const info = currencyInfo[currency] || { name: currency, flag: "üè≥Ô∏è" };
                    const optionText = `${info.flag} ${currency} - ${info.name}`;
                    fromSelect.add(new Option(optionText, currency));
                    toSelect.add(new Option(optionText, currency));
                });

                // Initialize Select2
                $('#fromCurrency, #toCurrency').select2({
                    templateResult: formatCurrency,
                    templateSelection: formatCurrency
                });

                // Load state from URL hash if it exists
                loadStateFromHash();

                // Add hash change listener
                window.addEventListener('hashchange', loadStateFromHash);

                // Only perform initial conversion if no hash exists
                if (!window.location.hash) {
                    $('#toCurrency').val('INR').trigger('change');
                    convertCurrency();
                }
            } catch (error) {
                console.error('Error fetching exchange rates:', error);
                document.getElementById('result').innerHTML = 'Error loading exchange rates';
            }
        }

        function formatCurrency(currency) {
            if (!currency.id) return currency.text;
            const currencyCode = currency.id;
            const info = currencyInfo[currencyCode] || { name: currencyCode, flag: "üè≥Ô∏è" };
            
            return $(`<span class="currency-option">
                <span class="currency-flag">${info.flag}</span>
                <span>${currencyCode} - ${info.name}</span>
            </span>`);
        }

        function convertCurrency() {
            const amount = document.getElementById('amount').value;
            const fromCurrency = document.getElementById('fromCurrency').value;
            const toCurrency = document.getElementById('toCurrency').value;

            // Convert to USD first (base rate), then to target currency
            const amountInUSD = amount / rates[fromCurrency];
            const finalAmount = amountInUSD * rates[toCurrency];

            document.getElementById('result').innerHTML = 
                `${amount} ${fromCurrency} = ${finalAmount.toFixed(2)} ${toCurrency}`;
            
            // Update URL hash after conversion
            updateHash();
        }

        function swapCurrencies() {
            const fromSelect = $('#fromCurrency');
            const toSelect = $('#toCurrency');
            const temp = fromSelect.val();
            fromSelect.val(toSelect.val()).trigger('change');
            toSelect.val(temp).trigger('change');
            convertCurrency();
        }

        function loadStateFromHash() {
            const hash = window.location.hash.slice(1); // Remove the # symbol
            if (hash) {
                const [fromCurrency, toCurrency, amount] = hash.split('/');
                if (fromCurrency && toCurrency && amount) {
                    $('#fromCurrency').val(fromCurrency).trigger('change');
                    $('#toCurrency').val(toCurrency).trigger('change');
                    $('#amount').val(amount);
                    convertCurrency();
                }
            }
        }

        function updateHash() {
            const fromCurrency = $('#fromCurrency').val();
            const toCurrency = $('#toCurrency').val();
            const amount = $('#amount').val();
            window.location.hash = `${fromCurrency}/${toCurrency}/${amount}`;
        }

        initialize();
    </script>
</body>
</html>